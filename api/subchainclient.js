import config from './lwconfig';
import BigNumber from 'bignumber.js';
import Chain3 from 'chain3';


// var chain3 = new Chain3(new Chain3.providers.HttpProvider("http://192.168.58.130:8545"));
var chain3 = new Chain3(new Chain3.providers.HttpProvider(config.vnodeIp)); 
var mc = chain3.mc;


// 子链地址
var subchainaddr1 = config.subChainAddr;
var subchainaddr2 = ""
// 测试账户
//0x93fec350603678c00f56e4c3637b99a39828b9e6
//0x3931453b00606a63222882a1836784adc2dfd1d3
var baseaddr = config.userAddr;
var basename = config.pwd;





var scsaddr1 = "0Xf687272ae00f8cea01b8cedf37dd9be30329d8cf"
var scsaddr2 = "0Xd616550b47a04baf69edf1844465877b0fed1782"
//var scsaddr5 = "0xa186b454d1affc30466d1d9b483402df5bde092b"
var scsaddr101 ="0x55989713e07a6545a62411114e3edc942e2ccd1c"
var scsaddr102 ="0xe1917e201aa6257ea9d17570a83bbfd13df9ff14"

// 大陆外服务器
var scsaddr301 = "0xb65c02c0540dff6769d8a93d1a740129b12d63f9"

//========2scs-vnode, 3scs-vnode, 3scs-vnode, 3scs-vnode ================
// 测试
var scsaddr401 = "0x907bc9cd294a58fde4f3f62f2f905f4f9b905267"
var scsaddr402 = "0xa946e0737ae3325b32dd185ee780f20582566a7b"
// 高鹏测试机
// 61号机器：
var scsaddr501 = "0xbe786007eda78fbd79cafadbd47c7ce57398f6b2"
var scsaddr502 = "0x4ff81da5f49a25b6a45111ae07dfb182241d82e5"
var scsaddr503 = "0x6a25bb675edd6eb12574051dbc0fc650de4bbfe1"
// 91号机器test1
var scsaddr504 = "0x402678cb8b8e38b21258ee830f82316a4a2221cd"
var scsaddr505 = "0xa31159174b3c78b65e8e72895239cfe5b600dde1"
var scsaddr506 = "0x402fdc664f98f964aac2c0559ffcb282d543822b"
// 92号机器test2
var scsaddr507 = "0xa5f57a36fb065c71845c2052178ecda2d5439ae5"
var scsaddr508 = "0x4b07e7e73b5f3b1e0fbff0ba1d92287af0df708b"
var scsaddr509 = "0xf149c0bfd7a7c572df37aacf070736a6140efca6"
// 31号机器
var scsaddr510 = "ab61323957c4c0c1bfdb8dd096069139dbb94974"
var scsaddr511 = "5a6ed879c2b6226ef270bc078ba71db9a42557ff"
var scsaddr512 = "79675b8d37286d5063a4ccf6c226c69848c4b191"
//========================================================================
var answerBond = "0.15";

export function createTopicSol(userAddr, pwd, amount, expblk, desc, subchainaddr, nonce)
{
	
	var award=chain3.toSha(amount,'mc')
	var data=deChatInstance.createTopic.getData(award, expblk, desc)
	sendshardingflagtx(userAddr, pwd,subchainaddr,amount,data,nonce)//transfer Token to dappa
}
function sendtx(src, tgtaddr, amount, strData) {

	chain3.mc.sendTransaction(
		{
			from: src,
			value:chain3.toSha(amount,'mc'),
			to: tgtaddr,
			gas: "9000000",
			gasPrice: chain3.mc.gasPrice,
			data: strData
			//via:'0x1b9CE7E4f156C1A28f2F1E0e38913a56cD9867'
		});
		
	console.log('sending from:' + 	src + ' to:' + tgtaddr  + ' with data:' + strData);

}
function sendmoac(tgtaddr, amount)
{
    chain3.personal.unlockAccount(u1, pwd,0);
    sendtx(u1, tgtaddr, amount ,'');
}

function sendmoactoscs(amount)
{
	sendmoac(scsaddr1, amount)
	sendmoac(scsaddr401, amount)
	sendmoac(scsaddr402, amount)
	//sendmoac(scsaddr510, amount)
	//sendmoac(scsaddr511, amount)
	//sendmoac(scsaddr512, amount)	
	//sendmoac(vnodeProtocolBaseAddr,amount)
	//sendmoac(subchainaddr1, 10)
	//sendmoac(subchainaddr2, 10)
}

// scsaddr 交保证金账户，这里用mc.accounts[0]给scsaddr交
function protocolregisterAll()
{
	protocolregister(baseaddr, basename, proto, scsaddr1)
	protocolregister(baseaddr, basename, proto, scsaddr401)
	protocolregister(baseaddr, basename, proto, scsaddr402)
	//protocolregister(baseaddr, basename, proto, scsaddr510)
	//protocolregister(baseaddr, basename, proto, scsaddr511)
	//protocolregister(baseaddr, basename, proto, scsaddr512)
	//vnoderegisterAll(baseaddr, basename,vnode)
}
function protocolregister(baseaddr,basename,protocoladdr,scsaddress)
{
	chain3.personal.unlockAccount(baseaddr,basename,0);
	//sendtx(baseaddr, protocoladdr, '11','0x4420e486000000000000000000000000f687272ae00f8cea01b8cedf37dd9be30329d8cf');
	sendtx(baseaddr, protocoladdr, '11','0x4420e486000000000000000000000000' + scsaddress.substr(2, 100));
}

// vnoderegisterAll(baseaddr,basename,vnode)
function vnoderegisterAll(baseAddr,basePasswd,vnodeAddr)
{
	chain3.personal.unlockAccount(baseAddr,basePasswd,0);
	sendtx(baseAddr, vnodeAddr, '11','0x32434a2e000000000000000000000000' + mc.accounts[1].substr(2, 100)
	+'0000000000000000000000000000000000000000000000000000000000000040'
	+'0000000000000000000000000000000000000000000000000000000000000013'
	//1 9 2 . 1 6 8 . 1 0 . 1 6 : 5 0 0 6 2
	+'3139322e3136382e31302e31363a353030363200000000000000000000000000');
	
	//chain3.personal.unlockAccount(baseAddr,basePasswd,0);
	//sendtx(baseAddr, vnodeAddr, '11','0x32434a2e000000000000000000000000' + mc.accounts[2].substr(2, 100)
	//+'0000000000000000000000000000000000000000000000000000000000000040'
	//+'0000000000000000000000000000000000000000000000000000000000000013'
	////1 9 2 . 1 6 8 . 1 0 . 3 1 : 5 0 0 6 2
	//+'3139322e3136382e31302e33313a353030363200000000000000000000000000');
}

//addFund(baseaddr, basename, subchainaddr1)
function addFund(dappaddr, dapppasswd,subchainaddr)
{
	chain3.personal.unlockAccount(dappaddr,dapppasswd,0);
	sendtx(dappaddr, subchainaddr, '1','0xa2f09dfa' );
}

//subchainregisterOpen(baseaddr, basename, subchainaddr1)
function subchainregisterOpen(dappaddr,dapppasswd,subchainaddr)
{
	chain3.personal.unlockAccount(dappaddr,dapppasswd,0);
	sendtx(dappaddr, subchainaddr, '0','0x5defc56c' );
}

//subchainregisterClose(baseaddr, basename, subchainaddr1)
function subchainregisterClose(dappaddr,dapppasswd,subchainaddr)
{
	chain3.personal.unlockAccount(dappaddr,dapppasswd,0);
	sendtx(dappaddr, subchainaddr, '0','0x69f3576f' );
}

// backup
function testregisterAdd(dappaddr,dapppasswd,subchainaddr)
{
        chain3.personal.unlockAccount(dappaddr,dapppasswd,0);
        sendtx(dappaddr, subchainaddr, '0','0xbe93f1b30000000000000000000000000000000000000000000000000000000000000020');
}
//getSCSRole(baseaddr, basename, subchainaddr1,scsaddr1)
function getSCSRole(dappaddr,dapppasswd,subchainaddr,scsaddress)
{
        chain3.personal.unlockAccount(dappaddr,dapppasswd,0);
        sendtx(baseaddr, subchainaddr, '0','0x50859fd9000000000000000000000000' + scsaddress.substr(2, 100));
}

// Send Sharding Flag tx
export function sendshardingflagtx(baseaddr,basename,subchainaddr,amount,code,n)
{
	
	return new Promise(function(resolve, reject){
		
		
		chain3.mc.sendTransaction(
			{
				from: baseaddr,
				value:chain3.toSha(amount,'mc'),
				to: subchainaddr,
				gas: '0',//'200000',
				gasPrice: '0',//chain3.mc.gasPrice,
				ShardingFlag: '0x1',
				data: code,
				nonce: n,
				via: config.via
			}, function (err, res) {
				resolve("111");
			
			})
		
		

	});	

	
		
	//console.log('sending from:' + 	src + ' to:' + tgtaddr  + ' with data:' + strData);
}

//sendSFToken(baseaddr,basename,subchainaddr1,to,1,n)
function sendSFToken(baseaddr,basename,subchainaddr,code,amount,n)
{
	chain3.personal.unlockAccount(baseaddr,basename,0);
	chain3.mc.sendTransaction(
		{
			from: baseaddr,
			value:chain3.toSha(amount,'mc'),
			to: subchainaddr,
			gas: '0',//'200000',
			gasPrice: '0',//chain3.mc.gasPrice,
			ShardingFlag:'0x2',
			data: code,
			nonce: n,
			via:'0x71bef1a57901d4c73de7683edb830f0b9914311a'//baseaddr
		});
		
	//console.log('sending from:' + 	src + ' to:' + tgtaddr  + ' with data:' + strData);
}

// start ============== wordcup sol test ======================================================================
function wordcupdeploy(subchainaddr)
{
	code='0x6060604052670de0b6b3a76400006001556127106002556040805190810160405280600381526020017f574354000000000000000000000000000000000000000000000000000000000081525060039080519060200190620000639291906200012a565b50600154621e8480026004556001546207a120026005556001546207a12002600655600154620f424002600755600154600a026008556001546103e80260095560015461271002600a55600154620f424002600b55600454600c553415620000ca57600080fd5b336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060008060146101000a81548160ff021916908315150217905550620001d9565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200016d57805160ff19168380011785556200019e565b828001600101855582156200019e579182015b828111156200019d57825182559160200191906001019062000180565b5b509050620001ad9190620001b1565b5090565b620001d691905b80821115620001d2576000816000905550600101620001b8565b5090565b90565b612dd580620001e96000396000f30060606040526004361061021a576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806306f837d31461021c578063128b90111461024557806312fc0bfd1461029257806315c446a2146102bb5780631c171364146102de5780632137a9f41461030b5780633116fbdb1461032e5780633ed2b77a1461037b578063402de3cb1461042557806343dc8b1e1461045e5780634768d4ef146104dc5780634d853ee5146105685780635432935a146105bd578063578d7f52146105e65780635e978b4c1461061357806366b3a8991461063c5780637301f27c14610692578063787f1e5d146106df5780637b61c3201461072c578063913ca3f5146107ba5780639b8b87ee14610807578063a8dd07dc1461082a578063b1924da014610853578063b2c87aea14610868578063b3227af9146108aa578063b4dd4a9114610900578063b683e5b814610929578063ba1c21e11461097f578063bcb4d4aa146109cc578063c5c86d65146109e1578063c6d5fe0f14610a32578063c95db90314610a74578063d70a08ef14610a9d578063d7ef073014610ac2578063d9b88f6014610aeb578063dbff4e3014610b41578063df57f67814610ba4578063e07439f714610bfc578063e57a611e14610c5f578063ee20a7cb14610c88578063f64dd4d614610cb1578063fc48d63014610d07578063fd720e2a14610d30578063ff7f5fad14610d59575b005b341561022757600080fd5b61022f610da8565b6040518082815260200191505060405180910390f35b341561025057600080fd5b61027c600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610dae565b6040518082815260200191505060405180910390f35b341561029d57600080fd5b6102a5610dc6565b6040518082815260200191505060405180910390f35b34156102c657600080fd5b6102dc6004808035906020019091905050610dcc565b005b34156102e957600080fd5b6102f1610e8b565b604051808215151515815260200191505060405180910390f35b341561031657600080fd5b61032c6004808035906020019091905050610e9e565b005b341561033957600080fd5b610365600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050610f27565b6040518082815260200191505060405180910390f35b341561038657600080fd5b61039c6004808035906020019091905050610f3f565b6040518084815260200180602001838152602001828103825284818151815260200191508051906020019080838360005b838110156103e85780820151818401526020810190506103cd565b50505050905090810190601f1680156104155780820380516001836020036101000a031916815260200191505b5094505050505060405180910390f35b341561043057600080fd5b61045c600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611001565b005b341561046957600080fd5b6104c2600480803590602001909190803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919050506110f5565b604051808215151515815260200191505060405180910390f35b34156104e757600080fd5b6104fd60048080359060200190919050506111a2565b604051808d81526020018c81526020018b81526020018a815260200189815260200188815260200187151515158152602001861515151581526020018581526020018481526020018381526020018281526020019c5050505050505050505050505060405180910390f35b341561057357600080fd5b61057b61121c565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b34156105c857600080fd5b6105d0611241565b6040518082815260200191505060405180910390f35b34156105f157600080fd5b6105f9611247565b604051808215151515815260200191505060405180910390f35b341561061e57600080fd5b61062661125a565b6040518082815260200191505060405180910390f35b341561064757600080fd5b61067c600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050611260565b6040518082815260200191505060405180910390f35b341561069d57600080fd5b6106c9600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611285565b6040518082815260200191505060405180910390f35b34156106ea57600080fd5b610712600480803590602001909190803590602001909190803590602001909190505061129d565b604051808215151515815260200191505060405180910390f35b341561073757600080fd5b61073f61138e565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561077f578082015181840152602081019050610764565b50505050905090810190601f1680156107ac5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156107c557600080fd5b6107f1600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061142c565b6040518082815260200191505060405180910390f35b341561081257600080fd5b6108286004808035906020019091905050611444565b005b341561083557600080fd5b61083d611cab565b6040518082815260200191505060405180910390f35b341561085e57600080fd5b610866611cb1565b005b341561087357600080fd5b6108a8600480803590602001909190803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050611ee5565b005b34156108b557600080fd5b6108ea600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050611fe2565b6040518082815260200191505060405180910390f35b341561090b57600080fd5b610913612007565b6040518082815260200191505060405180910390f35b341561093457600080fd5b610969600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803590602001909190505061200d565b6040518082815260200191505060405180910390f35b341561098a57600080fd5b6109b6600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050612032565b6040518082815260200191505060405180910390f35b34156109d757600080fd5b6109df61204a565b005b34156109ec57600080fd5b610a18600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091905050612323565b604051808215151515815260200191505060405180910390f35b3415610a3d57600080fd5b610a72600480803590602001909190803573ffffffffffffffffffffffffffffffffffffffff169060200190919050506123c9565b005b3415610a7f57600080fd5b610a87612468565b6040518082815260200191505060405180910390f35b3415610aa857600080fd5b610ac06004808035151590602001909190505061246e565b005b3415610acd57600080fd5b610ad56124e6565b6040518082815260200191505060405180910390f35b3415610af657600080fd5b610b2760048080359060200190919080359060200190919080359060200190919080359060200190919050506124ec565b604051808215151515815260200191505060405180910390f35b3415610b4c57600080fd5b610b6260048080359060200190919050506125f0565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b610be2600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190803590602001909190803590602001909190505061262f565b604051808215151515815260200191505060405180910390f35b3415610c0757600080fd5b610c1d6004808035906020019091905050612988565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b3415610c6a57600080fd5b610c726129c7565b6040518082815260200191505060405180910390f35b3415610c9357600080fd5b610c9b6129cd565b6040518082815260200191505060405180910390f35b3415610cbc57600080fd5b610cf1600480803573ffffffffffffffffffffffffffffffffffffffff169060200190919080359060200190919050506129d3565b6040518082815260200191505060405180910390f35b3415610d1257600080fd5b610d1a6129f8565b6040518082815260200191505060405180910390f35b3415610d3b57600080fd5b610d436129fe565b6040518082815260200191505060405180910390f35b610d8e600480803573ffffffffffffffffffffffffffffffffffffffff16906020019091908035906020019091905050612a04565b604051808215151515815260200191505060405180910390f35b60025481565b60116020528060005260406000206000915090505481565b600c5481565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610e2757600080fd5b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f193505050501515610e8857600080fd5b50565b600060149054906101000a900460ff1681565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515610ef957600080fd5b600060146000838152602001908152602001600020600001541415610f1d57600080fd5b80601c8190555050565b600f6020528060005260406000206000915090505481565b6014602052806000526040600020600091509050806000015490806001018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610ff15780601f10610fc657610100808354040283529160200191610ff1565b820191906000526020600020905b815481529060010190602001808311610fd457829003601f168201915b5050505050908060020154905083565b6000600e60008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000205414156110ad57600d805480600101828161105d9190612cd8565b9160005260206000209001600083909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550505b6001600e60008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000208190555050565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561115257600080fd5b82601460008581526020019081526020016000206000018190555081601460008581526020019081526020016000206001019080519060200190611197929190612d04565b506001905092915050565b60176020528060005260406000206000915090508060000154908060010154908060020154908060030154908060040154908060050154908060060160009054906101000a900460ff16908060060160019054906101000a900460ff169080600701549080600801549080600901549080600a015490508c565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600b5481565b601b60009054906101000a900460ff1681565b600a5481565b6018602052816000526040600020602052806000526040600020600091509150505481565b60106020528060005260406000206000915090505481565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156112fa57600080fd5b60006017600086815260200190815260200160002060000154141561131e57600080fd5b82601760008681526020019081526020016000206004018190555081601760008681526020019081526020016000206005018190555060016017600086815260200190815260200160002060060160006101000a81548160ff021916908315150217905550600190509392505050565b60038054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156114245780601f106113f957610100808354040283529160200191611424565b820191906000526020600020905b81548152906001019060200180831161140757829003601f168201915b505050505081565b60136020528060005260406000206000915090505481565b6000806000806000806000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156114a857600080fd5b6017600088815260200190815260200160002060060160009054906101000a900460ff1615156114d757600080fd5b6017600088815260200190815260200160002060060160019054906101000a900460ff161561150557600080fd5b60176000888152602001908152602001600020600701549550600d8054905094506000935060009250600091506000905060176000888152602001908152602001600020600501546017600089815260200190815260200160002060040154118015611587575060006017600089815260200190815260200160002060080154115b156117b357600093505b8484101561177f57600d848154811015156115a857fe5b906000526020600020900160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169250601960008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000600260038a0201815260200190815260200160002054601860008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000600260038b020181526020019081526020016000205403915060008211156117725781601960008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000600260038b0201815260200190815260200160002060008282540192505081905550600254601760008981526020019081526020016000206008015483880281151561171a57fe5b0481151561172457fe5b0490506117318184611ee5565b8273ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f19350505050151561177157600080fd5b5b8380600101945050611591565b60016017600089815260200190815260200160002060060160016101000a81548160ff021916908315150217905550611ca2565b601760008881526020019081526020016000206005015460176000898152602001908152602001600020600401541480156118045750600060176000898152602001908152602001600020600a0154115b15611a3057600093505b848410156119fc57600d8481548110151561182557fe5b906000526020600020900160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169250601960008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000600160038a0201815260200190815260200160002054601860008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000600160038b020181526020019081526020016000205403915060008211156119ef5781601960008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000600160038b020181526020019081526020016000206000828254019250508190555060025460176000898152602001908152602001600020600a015483880281151561199757fe5b048115156119a157fe5b0490506119ae8184611ee5565b8273ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f1935050505015156119ee57600080fd5b5b838060010194505061180e565b60016017600089815260200190815260200160002060060160016101000a81548160ff021916908315150217905550611ca1565b60176000888152602001908152602001600020600501546017600089815260200190815260200160002060040154108015611a81575060006017600089815260200190815260200160002060090154115b15611ca057600093505b84841015611c7057600d84815481101515611aa257fe5b906000526020600020900160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169250601960008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600060038902815260200190815260200160002054601860008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600060038a028152602001908152602001600020540391506000821115611c635781601960008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600060038a028152602001908152602001600020600082825401925050819055506002546017600089815260200190815260200160002060090154838802811515611c0b57fe5b04811515611c1557fe5b049050611c228184611ee5565b8273ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f193505050501515611c6257600080fd5b5b8380600101945050611a8b565b60016017600089815260200190815260200160002060060160016101000a81548160ff0219169083151502179055505b5b5b50505050505050565b60045481565b6000806000806000806000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16141515611d1557600080fd5b6012805490509550600a861115611d2b57600a95505b60009450600093506000915060009050600093505b85841015611dd657601284815481101515611d5757fe5b906000526020600020900160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169250601360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054850194508380600101945050611d40565b600093505b85841015611edd57601284815481101515611df257fe5b906000526020600020900160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169250601360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549150600254856007548402811515611e7457fe5b04811515611e7e57fe5b04905060075460025482021015611ed0578273ffffffffffffffffffffffffffffffffffffffff166108fc829081150290604051600060405180830381858888f193505050501515611ecf57600080fd5b5b8380600101945050611ddb565b505050505050565b6000601360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020541415611f915760128054806001018281611f419190612cd8565b9160005260206000209001600083909190916101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550505b81601360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825401925050819055505050565b6016602052816000526040600020602052806000526040600020600091509150505481565b60065481565b6019602052816000526040600020602052806000526040600020600091509150505481565b600e6020528060005260406000206000915090505481565b6000806000806000806000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156120ae57600080fd5b601b60009054906101000a900460ff16156120c857600080fd5b6000601c5414156120d857600080fd5b601a549550600d805490509450600060146000601c54815260200190815260200160002060020154141561210b57600080fd5b600093506000925060009150600090505b8481101561230057600d8181548110151561213357fe5b906000526020600020900160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169350601660008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000601c54815260200190815260200160002054601560008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000601c5481526020019081526020016000205403925060008311156122f35782601660008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000601c5481526020019081526020016000206000828254019250508190555060025460146000601c5481526020019081526020016000206002015484880281151561229b57fe5b048115156122a557fe5b0491506122b28285611ee5565b8373ffffffffffffffffffffffffffffffffffffffff166108fc839081150290604051600060405180830381858888f1935050505015156122f257600080fd5b5b808060010191505061211c565b6001601b60006101000a81548160ff021916908315150217905550505050505050565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561238057600080fd5b816000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060019050919050565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561242457600080fd5b8073ffffffffffffffffffffffffffffffffffffffff166108fc839081150290604051600060405180830381858888f19350505050151561246457600080fd5b5050565b601a5481565b6000809054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161415156124c957600080fd5b80600060146101000a81548160ff02191690831515021790555050565b60015481565b60008060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614151561254957600080fd5b84601760008781526020019081526020016000206000018190555083601760008781526020019081526020016000206001018190555082601760008781526020019081526020016000206002018190555081601760008781526020019081526020016000206003018190555060006017600087815260200190815260200160002060060160006101000a81548160ff02191690831515021790555060019050949350505050565b6012818154811015156125ff57fe5b90600052602060002090016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b600080600060149054906101000a900460ff161561264c57600080fd5b600254600a5481151561265b57fe5b0434101561266857600080fd5b600254600b5481151561267757fe5b0434111561268457600080fd5b42601760008681526020019081526020016000206003015410156126a757600080fd5b600090506003831080156126bc575060008310155b1561285c576008546005541015801561271457506000600f60008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054145b1561277957600854600f60008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550600854600560008282540392505081905550600854810190505b600954600654101580156127cc57506000601060008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054145b1561283157600954601060008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550600954600660008282540392505081905550600954810190505b6002543402810190506002543402600c6000828254019250508190555061285785611001565b612861565b600080fd5b80601860008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600086600302860181526020019081526020016000206000828254019250508190555060008314156128f657806017600086815260200190815260200160002060090160008282540192505081905550612958565b6001831415612928578060176000868152602001908152602001600020600a0160008282540192505081905550612957565b6002831415612956578060176000868152602001908152602001600020600801600082825401925050819055505b5b5b80601760008681526020019081526020016000206007016000828254019250508190555060019150509392505050565b600d8181548110151561299757fe5b90600052602060002090016000915054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b60075481565b60095481565b6015602052816000526040600020602052806000526040600020600091509150505481565b60055481565b60085481565b600080600060149054906101000a900460ff1615612a2157600080fd5b600060146000858152602001908152602001600020600001541415612a4557600080fd5b600254600a54811515612a5457fe5b04341015612a6157600080fd5b600254600b54811515612a7057fe5b04341115612a7d57600080fd5b4260176000603d8152602001908152602001600020600301541015612aa157600080fd5b6000905060085460055410158015612af857506000600f60008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054145b15612b5d57600854600f60008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550600854600560008282540392505081905550600854810190505b60095460065410158015612bb057506000601060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054145b15612c1557600954601060008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002081905550600954600660008282540392505081905550600954810190505b6002543402600c6000828254019250508190555060025434028101905080601a6000828254019250508190555080601460008581526020019081526020016000206002016000828254019250508190555080601560008673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600085815260200190815260200160002060008282540192505081905550612ccd84611001565b600191505092915050565b815481835581811511612cff57818360005260206000209182019101612cfe9190612d84565b5b505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10612d4557805160ff1916838001178555612d73565b82800160010185558215612d73579182015b82811115612d72578251825591602001919060010190612d57565b5b509050612d809190612d84565b5090565b612da691905b80821115612da2576000816000905550600101612d8a565b5090565b905600a165627a7a72305820d43a11881f3d00c2ef0c262af2a84e02c3476bf1da69bfec3d474db848f7778d0029'
	sendshardingflagtx(baseaddr,basename,subchainaddr,'0',code,1)
}

// 0x49e4A8fEAe858081d1c09563E5464484e281C04A
function test(subchainaddr,n)
{
	sendshardingflagtx(baseaddr,basename,subchainaddr,'0','',n)
}
// end   ============== wordcup sol test ======================================================================\

// start ============== Pmb sol test ======================================================================
//"1122334455667788", true
function OneRaiseHand()
{
	chain3.personal.unlockAccount(baseaddr,basename,0);
	sendtx(baseaddr, subchainaddr1, '1','0x7980d904'
	+'0000000000000000000000000000000000000000000000000000000000000040'
	+'0000000000000000000000000000000000000000000000000000000000000001'
	+'0000000000000000000000000000000000000000000000000000000000000010'
	//1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8
	+'3131323233333434353536363737383830303000000000000000000000000000');
}
// "liuxionog", "123", "111111@qq.com"
function UserRegister()
{
	chain3.personal.unlockAccount(baseaddr,basename,0);
	sendtx(baseaddr, subchainaddr1, '1','aa1e896f'
	+'0000000000000000000000000000000000000000000000000000000000000060'
	+'00000000000000000000000000000000000000000000000000000000000000a0'
	+'00000000000000000000000000000000000000000000000000000000000000e0'
	+'0000000000000000000000000000000000000000000000000000000000000009'
	+'6c697578696f6e6f670000000000000000000000000000000000000000000000'
	+'0000000000000000000000000000000000000000000000000000000000000003'
	+'3132330000000000000000000000000000000000000000000000000000000000'
	+'000000000000000000000000000000000000000000000000000000000000000d'
	+'3131313131314071712e636f6d00000000000000000000000000000000000000');
}
// end   ============== Pmb sol test ======================================================================

function subchaindeploycode(subchainaddr,code,nonce)
{
	//ipfs='0x6060604052341561000f57600080fd5b6111fb8061001e6000396000f30060606040526004361061008e576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff1680630f560cd714610093578063616ffe83146100bc57806380599e4b14610119578063ba3835ba14610176578063bb9c6c3e146101de578063c110f4c91461023b578063e9a734ff146102d7578063f4c714b41461038f575b600080fd5b341561009e57600080fd5b6100a6610436565b6040518082815260200191505060405180910390f35b34156100c757600080fd5b610117600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610442565b005b341561012457600080fd5b610174600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610550565b005b341561018157600080fd5b6101dc600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919080351515906020019091905050610807565b005b34156101e957600080fd5b610239600480803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610ad0565b005b341561024657600080fd5b61025c6004808035906020019091905050610bdd565b6040518080602001828103825283818151815260200191508051906020019080838360005b8381101561029c578082015181840152602081019050610281565b50505050905090810190601f1680156102c95780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156102e257600080fd5b610375600480803590602001908201803590602001908080601f0160208091040260200160405190810160405280939291908181526020018383808284378201915050505050509190803590602001908201803590602001908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505091905050610c99565b604051808215151515815260200191505060405180910390f35b341561039a57600080fd5b6103b06004808035906020019091905050610df6565b604051808060200183151515158152602001828103825284818151815260200191508051906020019080838360005b838110156103fa5780820151818401526020810190506103df565b50505050905090810190601f1680156104275780820380516001836020036101000a031916815260200191505b50935050505060405180910390f35b60008080549050905090565b600a73ffffffffffffffffffffffffffffffffffffffff1663b292c6cd826000600381111561046d57fe5b60018081111561047957fe5b6040518463ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001848152602001838152602001828103825285818151815260200191508051906020019080838360005b838110156104f05780820151818401526020810190506104d5565b50505050905090810190601f16801561051d5780820380516001836020036101000a031916815260200191505b50945050505050600060405180830381600087803b151561053d57600080fd5b5af1151561054a57600080fd5b50505050565b60008060008054905091505b60008211156106f7576106248360006001850381548110151561057b57fe5b90600052602060002090018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561061a5780601f106105ef5761010080835404028352916020019161061a565b820191906000526020600020905b8154815290600101906020018083116105fd57829003601f168201915b5050505050610c99565b156106e9576001820390505b6001600080549050038110156106a45760006001820181548110151561065257fe5b906000526020600020900160008281548110151561066c57fe5b90600052602060002090019080546001816001161561010002031660029004610696929190610ece565b508080600101915050610630565b60006001600080549050038154811015156106bb57fe5b906000526020600020900160006106d29190610f55565b60008054809190600190036106e79190610f9d565b505b81806001900392505061055c565b600a73ffffffffffffffffffffffffffffffffffffffff1663b292c6cd846002600381111561072257fe5b60018081111561072e57fe5b6040518463ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001848152602001838152602001828103825285818151815260200191508051906020019080838360005b838110156107a557808201518184015260208101905061078a565b50505050905090810190601f1680156107d25780820380516001836020036101000a031916815260200191505b50945050505050600060405180830381600087803b15156107f257600080fd5b5af115156107ff57600080fd5b505050505050565b60008060008054905091505b60008211156108f3576108db8460006001850381548110151561083257fe5b90600052602060002090018054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156108d15780601f106108a6576101008083540402835291602001916108d1565b820191906000526020600020905b8154815290600101906020018083116108b457829003601f168201915b5050505050610c99565b156108e557610aca565b818060019003925050610813565b600080548060010182816109079190610fc9565b91600052602060002090016000869091909150908051906020019061092d929190610ff5565b5050600180548060010182816109439190611075565b9160005260206000209060020201600060408051908101604052808881526020018715158152509091909150600082015181600001908051906020019061098b9291906110a7565b5060208201518160010160006101000a81548160ff0219169083151502179055505050506001905082156109be57600090505b600a73ffffffffffffffffffffffffffffffffffffffff1663b292c6cd85600160038111156109e957fe5b8460018111156109f557fe5b6040518463ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001848152602001838152602001828103825285818151815260200191508051906020019080838360005b83811015610a6c578082015181840152602081019050610a51565b50505050905090810190601f168015610a995780820380516001836020036101000a031916815260200191505b50945050505050600060405180830381600087803b1515610ab957600080fd5b5af11515610ac657600080fd5b5050505b50505050565b600a73ffffffffffffffffffffffffffffffffffffffff1663b292c6cd82600380811115610afa57fe5b600180811115610b0657fe5b6040518463ffffffff167c01000000000000000000000000000000000000000000000000000000000281526004018080602001848152602001838152602001828103825285818151815260200191508051906020019080838360005b83811015610b7d578082015181840152602081019050610b62565b50505050905090810190601f168015610baa5780820380516001836020036101000a031916815260200191505b50945050505050600060405180830381600087803b1515610bca57600080fd5b5af11515610bd757600080fd5b50505050565b600081815481101515610bec57fe5b90600052602060002090016000915090508054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610c915780601f10610c6657610100808354040283529160200191610c91565b820191906000526020600020905b815481529060010190602001808311610c7457829003601f168201915b505050505081565b6000610ca3611127565b610cab611127565b600085925084915081518351141515610cc75760009350610ded565b600090505b8251811015610de8578181815181101515610ce357fe5b9060200101517f010000000000000000000000000000000000000000000000000000000000000090047f0100000000000000000000000000000000000000000000000000000000000000027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff19168382815181101515610d5e57fe5b9060200101517f010000000000000000000000000000000000000000000000000000000000000090047f0100000000000000000000000000000000000000000000000000000000000000027effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916141515610ddb5760009350610ded565b8080600101915050610ccc565b600193505b50505092915050565b600181815481101515610e0557fe5b9060005260206000209060020201600091509050806000018054600181600116156101000203166002900480601f016020809104026020016040519081016040528092919081815260200182805460018160011615610100020316600290048015610eb15780601f10610e8657610100808354040283529160200191610eb1565b820191906000526020600020905b815481529060010190602001808311610e9457829003601f168201915b5050505050908060010160009054906101000a900460ff16905082565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f10610f075780548555610f44565b82800160010185558215610f4457600052602060002091601f016020900482015b82811115610f43578254825591600101919060010190610f28565b5b509050610f51919061113b565b5090565b50805460018160011615610100020316600290046000825580601f10610f7b5750610f9a565b601f016020900490600052602060002090810190610f99919061113b565b5b50565b815481835581811511610fc457818360005260206000209182019101610fc39190611160565b5b505050565b815481835581811511610ff057818360005260206000209182019101610fef9190611160565b5b505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061103657805160ff1916838001178555611064565b82800160010185558215611064579182015b82811115611063578251825591602001919060010190611048565b5b509050611071919061113b565b5090565b8154818355818115116110a2576002028160020283600052602060002091820191016110a1919061118c565b5b505050565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106110e857805160ff1916838001178555611116565b82800160010185558215611116579182015b828111156111155782518255916020019190600101906110fa565b5b509050611123919061113b565b5090565b602060405190810160405280600081525090565b61115d91905b80821115611159576000816000905550600101611141565b5090565b90565b61118991905b80821115611185576000818161117c9190610f55565b50600101611166565b5090565b90565b6111cc91905b808211156111c857600080820160006111ab9190610f55565b6001820160006101000a81549060ff021916905550600201611192565b5090565b905600a165627a7a7230582070d73f5e1ada5a5f0898a7cdcf0145491a12ab2ef883461b1505576831da1e250029'
    // erc20='0x606060409081526003805460a060020a60ff02191690558051908101604052600981527f5465737420436f696e00000000000000000000000000000000000000000000006020820152600490805161005b9291602001906100f6565b5060408051908101604052600481527f5445535400000000000000000000000000000000000000000000000000000000602082015260059080516100a39291602001906100f6565b5060068055655af3107a400060075534156100bd57600080fd5b60038054600160a060020a03191633600160a060020a031690811790915560075460008181559182526001602052604090912055610191565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061013757805160ff1916838001178555610164565b82800160010185558215610164579182015b82811115610164578251825591602001919060010190610149565b50610170929150610174565b5090565b61018e91905b80821115610170576000815560010161017a565b90565b610d38806101a06000396000f3006060604052600436106100fb5763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166306fdde038114610100578063095ea7b31461018a57806318160ddd146101c057806323b872dd146101e55780632e1a7d4d1461020d5780632ff2e9dc14610225578063313ce567146102385780633f4ba83a1461024b5780635c975abb1461025e578063661884631461027157806370a08231146102935780638456cb59146102b25780638da5cb5b146102c557806395d89b41146102f4578063a9059cbb14610307578063d73dd62314610329578063dd62ed3e1461034b578063f2fde38b14610370575b600080fd5b341561010b57600080fd5b61011361038f565b60405160208082528190810183818151815260200191508051906020019080838360005b8381101561014f578082015183820152602001610137565b50505050905090810190601f16801561017c5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b341561019557600080fd5b6101ac600160a060020a036004351660243561042d565b604051901515815260200160405180910390f35b34156101cb57600080fd5b6101d3610458565b60405190815260200160405180910390f35b34156101f057600080fd5b6101ac600160a060020a036004358116906024351660443561045e565b341561021857600080fd5b61022360043561048b565b005b341561023057600080fd5b6101d3610534565b341561024357600080fd5b6101d361053a565b341561025657600080fd5b610223610540565b341561026957600080fd5b6101ac6105bf565b341561027c57600080fd5b6101ac600160a060020a03600435166024356105cf565b341561029e57600080fd5b6101d3600160a060020a03600435166105f3565b34156102bd57600080fd5b61022361060e565b34156102d057600080fd5b6102d8610692565b604051600160a060020a03909116815260200160405180910390f35b34156102ff57600080fd5b6101136106a1565b341561031257600080fd5b6101ac600160a060020a036004351660243561070c565b341561033457600080fd5b6101ac600160a060020a0360043516602435610730565b341561035657600080fd5b6101d3600160a060020a0360043581169060243516610754565b341561037b57600080fd5b610223600160a060020a036004351661077f565b60048054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156104255780601f106103fa57610100808354040283529160200191610425565b820191906000526020600020905b81548152906001019060200180831161040857829003601f168201915b505050505081565b60035460009060a060020a900460ff161561044757600080fd5b610451838361081a565b9392505050565b60005481565b60035460009060a060020a900460ff161561047857600080fd5b610483848484610886565b949350505050565b600160a060020a033316600090815260016020526040902054819010156104b157600080fd5b4360009081526008602052604090208054600181016104d08382610cc2565b506000918252602080832091909101805473ffffffffffffffffffffffffffffffffffffffff191633600160a060020a0316179055438252600890526040902060019081018054909181016105258382610cc2565b50600091825260209091200155565b60075481565b60065481565b60035433600160a060020a0390811691161461055b57600080fd5b60035460a060020a900460ff16151561057357600080fd5b6003805474ff0000000000000000000000000000000000000000191690557f7805862f689e2f13df9f062ff482ad3ad112aca9e0847911ed832e158c525b3360405160405180910390a1565b60035460a060020a900460ff1681565b60035460009060a060020a900460ff16156105e957600080fd5b6104518383610a08565b600160a060020a031660009081526001602052604090205490565b60035433600160a060020a0390811691161461062957600080fd5b60035460a060020a900460ff161561064057600080fd5b6003805474ff0000000000000000000000000000000000000000191660a060020a1790557f6985a02210a168e66602d3235cb6db0e70f92b3ba4d376a33c0f3d9434bff62560405160405180910390a1565b600354600160a060020a031681565b60058054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156104255780601f106103fa57610100808354040283529160200191610425565b60035460009060a060020a900460ff161561072657600080fd5b6104518383610b02565b60035460009060a060020a900460ff161561074a57600080fd5b6104518383610bfd565b600160a060020a03918216600090815260026020908152604080832093909416825291909152205490565b60035433600160a060020a0390811691161461079a57600080fd5b600160a060020a03811615156107af57600080fd5b600354600160a060020a0380831691167f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e060405160405180910390a36003805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a0392909216919091179055565b600160a060020a03338116600081815260026020908152604080832094871680845294909152808220859055909291907f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b9259085905190815260200160405180910390a350600192915050565b6000600160a060020a038316151561089d57600080fd5b600160a060020a0384166000908152600160205260409020548211156108c257600080fd5b600160a060020a03808516600090815260026020908152604080832033909416835292905220548211156108f557600080fd5b600160a060020a03841660009081526001602052604090205461091e908363ffffffff610ca116565b600160a060020a038086166000908152600160205260408082209390935590851681522054610953908363ffffffff610cb316565b600160a060020a0380851660009081526001602090815260408083209490945587831682526002815283822033909316825291909152205461099b908363ffffffff610ca116565b600160a060020a03808616600081815260026020908152604080832033861684529091529081902093909355908516917fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9085905190815260200160405180910390a35060019392505050565b600160a060020a03338116600090815260026020908152604080832093861683529290529081205480831115610a6557600160a060020a033381166000908152600260209081526040808320938816835292905290812055610a9c565b610a75818463ffffffff610ca116565b600160a060020a033381166000908152600260209081526040808320938916835292905220555b600160a060020a0333811660008181526002602090815260408083209489168084529490915290819020547f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925915190815260200160405180910390a35060019392505050565b6000600160a060020a0383161515610b1957600080fd5b600160a060020a033316600090815260016020526040902054821115610b3e57600080fd5b600160a060020a033316600090815260016020526040902054610b67908363ffffffff610ca116565b600160a060020a033381166000908152600160205260408082209390935590851681522054610b9c908363ffffffff610cb316565b600160a060020a0380851660008181526001602052604090819020939093559133909116907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9085905190815260200160405180910390a350600192915050565b600160a060020a033381166000908152600260209081526040808320938616835292905290812054610c35908363ffffffff610cb316565b600160a060020a0333811660008181526002602090815260408083209489168084529490915290819020849055919290917f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92591905190815260200160405180910390a350600192915050565b600082821115610cad57fe5b50900390565b60008282018381101561045157fe5b815481835581811511610ce657600083815260209020610ce6918101908301610ceb565b505050565b610d0991905b80821115610d055760008155600101610cf1565b5090565b905600a165627a7a72305820f09ac3615c92e9a25d1ef5467e30a6988e4cef6ed868a484806419c4eaee7d900029'
	sendshardingflagtx(baseaddr,basename,subchainaddr,'0',code,nonce)
}
//  ============== simplestorage sol start =============================================================
function simpleDeploy(subchainaddr,nonce)//3390a53e44e7b00b0b9f40152f0bb5eb742f760f
{
	simple='0x608060405234801561001057600080fd5b50610108806100206000396000f300608060405260043610605c5763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166321362117811460615780632d910f2c1460785780634b6e7d7814608a57806376b8e5281460ae575b600080fd5b348015606c57600080fd5b50607660043560c0565b005b348015608357600080fd5b50607660c5565b348015609557600080fd5b50609c60d0565b60408051918252519081900360200190f35b34801560b957600080fd5b50609c60d6565b600055565b600080546001019055565b60005481565b600054905600a165627a7a723058201ea3e9f22371704bfb5b0774a1554e8edefb62a6e819c680d610222f9693455a0029'
	subchaindeploycode(subchainaddr,simple,nonce)
}
function simpleAddOne(subchainaddr,n)
{
	sendshardingflagtx(baseaddr,basename,subchainaddr,'0','0x2d910f2c',n)
}
function simpleGet(subchainaddr,n)
{
	sendshardingflagtx(baseaddr,basename,subchainaddr,'0','0x76b8e528',n)
}
function subchainCodeSend(subchainaddr,n,m)
{
	for (var i=n;i<m;i++)
	{
		subchainCodeAddOne(subchainaddr,i)
		sleep(2000);
	}
}

function testflushwithlargevia(subchainaddr,start,end)
{
	for (index = start; index < end; index++){
		//sleep(2000)
		var tmp = pad(index,8);
		console.log(tmp+' ')
		chain3.personal.unlockAccount(baseaddr,basename,0);
		chain3.mc.sendTransaction(
		{
			from: baseaddr,
			value:chain3.toSha('0','mc'),//test 1mc
			to: subchainaddr,
			gas: "200000",//200000
			gasPrice: chain3.mc.gasPrice,
			ShardingFlag:1,
			data: '0xe8927fbc',
			nonce: index,
			via:'0x71bef1a57901d4c73de7683edb830f0b9914311a'
			//via:'0x18000000000000000000000000000000'+tmp,
		});
	}
}

//pad(100, 4);  // 输出：0100
function pad(num, n) {
  var value = num.toString(16)
  var len = value.length;
  while(len < n) {
    value = "0" + value;
    len++;
  }
  return value;
}


//  ============== simplestorage sol end ===============================================================
// start ============== DeChat sol start ===================================================================
// 3390a53e44e7b00b0b9f40152f0bb5eb742f760f   
var deChatABI='[{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"name\":\"topics\",\"outputs\":[{\"name\":\"hash\",\"type\":\"bytes32\"},{\"name\":\"owner\",\"type\":\"address\"},{\"name\":\"desc\",\"type\":\"string\"},{\"name\":\"award\",\"type\":\"uint256\"},{\"name\":\"expblk\",\"type\":\"uint256\"},{\"name\":\"bestVoteCount\",\"type\":\"uint256\"},{\"name\":\"bestHash\",\"type\":\"bytes32\"},{\"name\":\"secondBestVoteCount\",\"type\":\"uint256\"},{\"name\":\"secondBestHash\",\"type\":\"bytes32\"},{\"name\":\"closed\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"addrs\",\"type\":\"address[]\"},{\"name\":\"addr\",\"type\":\"address\"}],\"name\":\"have\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"newTopicList\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"firstPrize\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newlist\",\"type\":\"address[]\"}],\"name\":\"updateNodeList\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"maxExpBlk\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"secondPrize\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"name\":\"subTopics\",\"outputs\":[{\"name\":\"hash\",\"type\":\"bytes32\"},{\"name\":\"owner\",\"type\":\"address\"},{\"name\":\"desc\",\"type\":\"string\"},{\"name\":\"parent\",\"type\":\"bytes32\"},{\"name\":\"voteCount\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"answerBond\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"curNodeList\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"bytes32\"},{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"topicAns\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"name\":\"voteinfo\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"flushhash\",\"type\":\"bytes32\"},{\"name\":\"tosend\",\"type\":\"address[]\"},{\"name\":\"amount\",\"type\":\"uint256[]\"}],\"name\":\"postFlush\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"testRetures\",\"outputs\":[{\"name\":\"name\",\"type\":\"string\"},{\"name\":\"data\",\"type\":\"uint256\"},{\"name\":\"addr\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"redeemFromMicroChain\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"autoCheck\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"parenthash\",\"type\":\"bytes32\"},{\"name\":\"desc\",\"type\":\"string\"}],\"name\":\"creatSubTopic\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"devPrize\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"expinfo\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"lastProcBlk\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"award\",\"type\":\"uint256\"},{\"name\":\"expblk\",\"type\":\"uint256\"},{\"name\":\"desc\",\"type\":\"string\"}],\"name\":\"createTopic\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"topichash\",\"type\":\"bytes32\"}],\"name\":\"voteOnTopic\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"votePrize\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"modPrize\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"voteAwardCount\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"mod\",\"type\":\"address\"},{\"name\":\"dev\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"name\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"data\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"addr\",\"type\":\"address\"}],\"name\":\"testReturesEvent\",\"type\":\"event\"}]'
var deChatAddr='0x0000000000000000000000000000000000000020'
var deChatContract=chain3.mc.contract(JSON.parse(deChatABI));
var deChatInstance=deChatContract.at(deChatAddr);
//deChatDeploy(subchainaddr1,0)
function deChatDeploy(subchainaddr,nonce)
{
	var code='0x608060405267016345785d8a0000600d556032600e556014600f556014601055600960115560016012556064601355603260145534801561003f57600080fd5b50604051604080611a0c8339810160405280516020909101516004805433600160a060020a0319918216811790925543600c55601580548216909217909155601780548216600160a060020a03948516179055601680549091169290911691909117905561195a806100b26000396000f3006080604052600436106101485763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416630f2fbeec811461014d57806310ba0499146102355780631b6226d7146102a95780632e98520c146102d357806331a06771146102e8578063364f87451461033f5780633d70bc521461035457806342c2b904146103695780635760daf7146104245780635b1222b4146104395780635ea6747c1461046d5780635f1f04bc146104885780636f0fe78b146104a05780637572f2531461053357806389739c5b146105e05780638a922f47146105e8578063957bceff146105fd578063a9e0ba7f1461064e578063ab7deceb14610663578063b63a5f491461067e578063d1ad7e3514610693578063e20f23cb146106e6578063eb9d0715146106fe578063ec5f931914610713578063ed4dddf614610728575b600080fd5b34801561015957600080fd5b5061016560043561073d565b604080518b8152600160a060020a038b16602080830191909152606082018a90526080820189905260a0820188905260c0820187905260e0820186905261010082018590528315156101208301526101409282018381528b51938301939093528a519192916101608401918c019080838360005b838110156101f15781810151838201526020016101d9565b50505050905090810190601f16801561021e5780820380516001836020036101000a031916815260200191505b509b50505050505050505050505060405180910390f35b34801561024157600080fd5b50604080516020600480358082013583810280860185019096528085526102959536959394602494938501929182918501908490808284375094975050509235600160a060020a0316935061082292505050565b604080519115158252519081900360200190f35b3480156102b557600080fd5b506102c160043561087d565b60408051918252519081900360200190f35b3480156102df57600080fd5b506102c161089c565b3480156102f457600080fd5b506040805160206004803580820135838102808601850190965280855261033d953695939460249493850192918291850190849080828437509497506108a29650505050505050565b005b34801561034b57600080fd5b506102c1610a40565b34801561036057600080fd5b506102c1610a46565b34801561037557600080fd5b50610381600435610a4c565b60408051868152600160a060020a038616602080830191909152606082018590526080820184905260a0928201838152865193830193909352855191929160c084019187019080838360005b838110156103e55781810151838201526020016103cd565b50505050905090810190601f1680156104125780820380516001836020036101000a031916815260200191505b50965050505050505060405180910390f35b34801561043057600080fd5b506102c1610b0e565b34801561044557600080fd5b50610451600435610b14565b60408051600160a060020a039092168252519081900360200190f35b34801561047957600080fd5b506102c1600435602435610b3c565b34801561049457600080fd5b506102c1600435610b6c565b3480156104ac57600080fd5b5060408051602060046024803582810135848102808701860190975280865261033d96843596369660449591949091019291829185019084908082843750506040805187358901803560208181028481018201909552818452989b9a998901989297509082019550935083925085019084908082843750949750610b7e9650505050505050565b34801561053f57600080fd5b50610548610dea565b604051808060200184815260200183600160a060020a0316600160a060020a03168152602001828103825285818151815260200191508051906020019080838360005b838110156105a357818101518382015260200161058b565b50505050905090810190601f1680156105d05780820380516001836020036101000a031916815260200191505b5094505050505060405180910390f35b61033d610edf565b3480156105f457600080fd5b5061033d610f24565b60408051602060046024803582810135601f81018590048502860185019096528585526102c19583359536956044949193909101919081908401838280828437509497506113469650505050505050565b34801561065a57600080fd5b506102c161145e565b34801561066f57600080fd5b506102c1600435602435611464565b34801561068a57600080fd5b506102c161147f565b604080516020600460443581810135601f81018490048402850184019095528484526102c19482359460248035953695946064949201919081908401838280828437509497506114859650505050505050565b3480156106f257600080fd5b5061033d60043561161e565b34801561070a57600080fd5b506102c16117d8565b34801561071f57600080fd5b506102c16117de565b34801561073457600080fd5b506102c16117e4565b60056020908152600091825260409182902080546001808301546002808501805488516101009582161595909502600019011691909104601f81018790048702840187019097528683529295600160a060020a03909116949192918301828280156107e95780601f106107be576101008083540402835291602001916107e9565b820191906000526020600020905b8154815290600101906020018083116107cc57829003601f168201915b50505050600383015460048401546005850154600686015460078701546008880154600990980154969794969395509193909260ff168a565b6000805b83518110156108715782600160a060020a0316848281518110151561084757fe5b90602001906020020151600160a060020a031614156108695760019150610876565b600101610826565b600091505b5092915050565b600a80548290811061088b57fe5b600091825260209091200154905081565b600e5481565b60045460009081908190600160a060020a03163314156108d15783516108cf9060019060208701906117ea565b505b8360405180828051906020019060200280838360005b838110156108ff5781810151838201526020016108e7565b5050505090500191505060405180910390209250600160405180828054801561095157602002820191906000526020600020905b8154600160a060020a03168152600190910190602001808311610933575b5050604051908190039020935050508282141561096d57610a3a565b60008381526003602090815260409182902080548351818402810184019094528084526109d993928301828280156109ce57602002820191906000526020600020905b8154600160a060020a031681526001909101906020018083116109b0575b505050505033610822565b9050801515610a3a576000838152600360209081526040822080546001810182558184529183209091018054600160a060020a031916331790558551918590525460029091041015610a3a578351610a389060019060208701906117ea565b505b50505050565b60145481565b600f5481565b60066020908152600091825260409182902080546001808301546002808501805488516101009582161595909502600019011691909104601f81018790048702840187019097528683529295600160a060020a0390911694919291830182828015610af85780601f10610acd57610100808354040283529160200191610af8565b820191906000526020600020905b815481529060010190602001808311610adb57829003601f168201915b5050505050908060030154908060040154905085565b600d5481565b6001805482908110610b2257fe5b600091825260209091200154600160a060020a0316905081565b600760205281600052604060002081815481101515610b5757fe5b90600052602060002001600091509150505481565b60096020526000908152604090205481565b600080610be360018054806020026020016040519081016040528092919081815260200182805480156109ce57602002820191906000526020600020908154600160a060020a031681526001909101906020018083116109b057505050505033610822565b1515610bee57600080fd5b8251845114610bfc57600080fd5b604051858152845186918691869190602080830191818601910280838360005b83811015610c34578181015183820152602001610c1c565b50505050905001828051906020019060200280838360005b83811015610c64578181015183820152602001610c4c565b50506040805195909301859003909420600081815260026020819052939020909201549199505060ff16159550610ca094505050505057610a38565b6000828152600260209081526040918290206001018054835181840281018401909452808452610d0d93928301828280156109ce57602002820191906000526020600020908154600160a060020a031681526001909101906020018083116109b057505050505033610822565b1515610a3857600082815260026020818152604083206001908101805480830182558186529285209092018054600160a060020a0319163317905554928590525491041015610a3857506000818152600260208190526040822001805460ff191660011790555b8351811015610a38578381815181101515610d8b57fe5b90602001906020020151600160a060020a03166108fc8483815181101515610daf57fe5b602090810290910101516040518115909202916000818181858888f19350505050158015610de1573d6000803e3d6000fd5b50600101610d74565b604080518082018252600681527f3131323233330000000000000000000000000000000000000000000000000000602080830191825260155484516064928101839052600160a060020a03909116948101859052606080825284519082015283519394919391927fd7f128c98140429a05f978756ee95eb9d8268927f50b1587c7b48290161df39a928692869286928291608083019180838360005b83811015610e9e578181015183820152602001610e86565b50505050905090810190601f168015610ecb5780820380516001836020036101000a031916815260200191505b5094505050505060405180910390a1909192565b4360009081526020818152604082208054600181810183558285528385209091018054600160a060020a03191633179055908101805491820181558352912034910155565b60008060008060008060008043600c54101515610f4057600080fd5b600c5497505b4388101561133c57600096505b600088815260086020526040902054871015611331576000888152600860205260409020805488908110610f8357fe5b6000918252602090912001549550851580610faf575060008681526005602052604090206009015460ff165b15610fb957611326565b6000868152600560209081526040808320600690810154808552925290912060010154909550600160a060020a03161561105557600085815260066020908152604080832060010154600e548a85526005909352922060030154600160a060020a03909216916108fc9160649102049081150290604051600060405180830381858888f19350505050158015611053573d6000803e3d6000fd5b505b600093505b60008581526006602052604090206005015484101561111757600085815260066020526040902060050180548590811061109057fe5b60009182526020808320909101548783526006825260408084206005908101546010548c875291909452932060030154600160a060020a03909116926108fc929160649102048115156110df57fe5b049081150290604051600060405180830381858888f1935050505015801561110b573d6000803e3d6000fd5b5060019093019261105a565b600086815260056020908152604080832060080154808452600690925290912060010154909350600160a060020a0316156111b457600083815260066020908152604080832060010154600f548a85526005909352922060030154600160a060020a03909216916108fc9160649102049081150290604051600060405180830381858888f193505050501580156111b2573d6000803e3d6000fd5b505b601754600160a060020a03161561121b57601754601154600088815260056020526040808220600301549051600160a060020a03909416936064919093020480156108fc02929091818181858888f19350505050158015611219573d6000803e3d6000fd5b505b601654600160a060020a03161561128257601654601254600088815260056020526040808220600301549051600160a060020a03909416936064919093020480156108fc02929091818181858888f19350505050158015611280573d6000803e3d6000fd5b505b6000868152600560205260409020600901805460ff19166001179055600a805460001981019081106112b057fe5b6000918252602080832090910154888352600b909152604090912054600a80549294509092508391839081106112e257fe5b6000918252602080832090910192909255838152600b90915260409020819055600a80549061131590600019830161184f565b506000868152600b60205260408120555b600190960195610f53565b600190970196610f46565b5050505050505050565b600080600d54341015151561135a57600080fd5b4333846040518084815260200183600160a060020a0316600160a060020a03166c0100000000000000000000000002815260140182805190602001908083835b602083106113b95780518252601f19909201916020918201910161139a565b51815160209384036101000a600019018019909216911617905260408051929094018290039091206000818152600683529390932083815560018101805433600160a060020a03199091161790558a5193985061142497506002019550890193509091506118739050565b5060008181526006602090815260408083206003018790558683526007825282208054600181018255908352912001819055905092915050565b60125481565b600860205281600052604060002081815481101515610b5757fe5b600c5481565b6000803485111561149557600080fd5b4333846040518084815260200183600160a060020a0316600160a060020a03166c0100000000000000000000000002815260140182805190602001908083835b602083106114f45780518252601f1990920191602091820191016114d5565b51815160001960209485036101000a019081169019919091161790526040805194909201849003909320600081815260059094529220828155600181018054600160a060020a031916331790556003018b90555060145490955088101593506115749250505057600081815260056020526040902060040184905561158a565b6014546000828152600560205260409020600401555b600081815260056020908152604090912084516115af92600290920191860190611873565b50438401600090815260086020908152604080832080546001818101835591855283852001859055600a8054868652600b909452918420839055820181559091527fc65a7bb8d6351c1cf70c95a316cc6a92839c986682d98bc35f958f4883f9d2a80181905590509392505050565b6000818152600660205260408120548190151561163a57600080fd5b600083815260066020526040902060030154915081151561165a57600080fd5b50604080516c010000000000000000000000003302815260148101839052815190819003603401902060008181526009602052919091205460011161169e57600080fd5b600081815260096020908152604080832060019081905586845260069092529091206004018054909101908190556013541115611707576000838152600660209081526040822060050180546001810182559083529120018054600160a060020a031916331790555b60008281526005602081815260408084209092015486845260069091529120600401541115611777576000828152600560208181526040808420600680820180546008840155828601805460079094019390935589905588865283529084206004015493869052919052556117d3565b60008281526005602090815260408083206007015486845260069092529091206004015411156117d357600082815260056020818152604080842060088101889055878552600683529084206004015493869052919052600701555b505050565b60105481565b60115481565b60135481565b82805482825590600052602060002090810192821561183f579160200282015b8281111561183f5782518254600160a060020a031916600160a060020a0390911617825560209092019160019091019061180a565b5061184b9291506118ed565b5090565b8154818355818111156117d3576000838152602090206117d3918101908301611914565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106118b457805160ff19168380011785556118e1565b828001600101855582156118e1579182015b828111156118e15782518255916020019190600101906118c6565b5061184b929150611914565b61191191905b8082111561184b578054600160a060020a03191681556001016118f3565b90565b61191191905b8082111561184b576000815560010161191a5600a165627a7a72305820b672dfd6d553bc720417ec80337c6c525a141334d37e914bf53a857dab788a880029'
	code += '000000000000000000000000' + mc.accounts[3].substr(2, 100)
	code += '000000000000000000000000' + mc.accounts[4].substr(2, 100)
	subchaindeploycode(subchainaddr,code,nonce)
}

function transferToken(recv, amount, subchainaddr, nonce)
{
	var data=deChatInstance.transferToken.getData(recv, amount)
	console.log(data)
	sendshardingflagtx(baseaddr,basename,subchainaddr,amount,data,nonce)
}
//createTopic(10, 10, '今年moac300刀吗？', subchainaddr1,1)
//data:0xd1ad7e35...
//改进：(1)一个账号连续投票；(2)lastProcBlk需要改进，不能每次从头开始应超过一定块号扣除基本费用自动关闭退回钱
//(3)各大参数用uint精度不够
//function createTopicSol(amount, expblk, desc, subchainaddr, nonce)
//{
//	var award=chain3.toSha(amount,'mc')
//	var data=deChatInstance.createTopic.getData(award, expblk, desc)
//	console.log(data)
//	sendshardingflagtx(baseaddr,basename,subchainaddr,'10',data,nonce)//transfer Token to dappa
//}
var topHash='0x' + 'c456527f086a32e01426623d164d03febc5461daf51495d688411d0891a3d863'
//creatSubTopic('是的', subchainaddr1,topHash,2)
export function createSubTopicSol(userAddr, pwd, desc, subchainaddr,topHash, nonce)
{
	var data=deChatInstance.creatSubTopic.getData(topHash, desc)
	//var data ='0x957bceff' + '000000000000000000000000000000000000000000000000000000003b9aca01'
	
	sendshardingflagtx(userAddr, pwd,subchainaddr,'3',data,nonce)
}

		
		

var subHash='0x' + '17068363937b53167d8e30e540b72d61bc6d35eb0c672d658e50910ad3b092f4'
//voteOnTopic(mc.accounts[1],'123',subchainaddr1,subHash, 0)
//voteOnTopic(mc.accounts[2],'123',subchainaddr1,subHash, 0)
export function voteOnTopic(vote, pwd, subchainaddr,subHash, nonce)
{
	var data=deChatInstance.voteOnTopic.getData(subHash)
	//console.log(data)
	sendshardingflagtx(vote,pwd,subchainaddr,'0',data,nonce)
}
//autoCheck(subchainaddr1, 3)
export function autoCheckSol(subchainaddr, nonce)
{
	var data=deChatInstance.autoCheck.getData()
	
	sendshardingflagtx(baseaddr,basename,subchainaddr,'0',data,nonce)
}
//testRetures(subchainaddr1, nonce)
function testRetures(subchainaddr, nonce)
{
	var data=deChatInstance.testRetures.getData()
	console.log(data)
	sendshardingflagtx(baseaddr,basename,subchainaddr,'0',data,nonce)	
}
// start ============== DeChat sol end =====================================================================
// start ============== ipfs sol start =====================================================================
function ipfswrite(subchainaddr,n)
{
	data='0xba3835ba00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002e516d5575464e5067664d46676b7a7a626750697363695262527445724755485a795862764e6e4a6b73664c536d65000000000000000000000000000000000000'
	sendshardingflagtx(baseaddr,basename,subchainaddr,'0',data,n)
}
function ipfsread(subchainaddr,n)
{
	data='616ffe83'
	+'0000000000000000000000000000000000000000000000000000000000000020'
	+'000000000000000000000000000000000000000000000000000000000000002e'
	+'516d643171727435436a3333686b6e6176726d5839594236374d6a45686d5370'
	+'78384a6f5a4c7062693335563448000000000000000000000000000000000000'
	sendshardingflagtx(baseaddr,basename,subchainaddr,'0',data,n)
}

function ipfsremove(subchainaddr,n)
{
	data="0x80599e4b0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000002e516d594c4c54644c7235454e4d48743769756b5a6a6f4d44344b447831697a47377137627573685646506673576e000000000000000000000000000000000000"
	sendshardingflagtx(baseaddr,basename,subchainaddr,'0',data,n)
}
// start ============== ipfs sol end ======================================================================

function sleep(numberMillis) {  
    var now = new Date();  
    var exitTime = now.getTime() + numberMillis;  
    while (true) {  
        now = new Date();  
        if (now.getTime() > exitTime)  
        return;  
        }  
} 

function printbase(subchainaddr)
{
	for (var index=0;index<50;index++){
		
		console.log(index+chain3.mc.getStorageAt(subchainaddr, index))
	}
}

function getStAt(addr) {
    for (index = 0; index < 20; index++){
        console.log(chain3.mc.getStorageAt(addr, index))
    }
}

function sendmoac(tgtaddr, amount)
{
    chain3.personal.unlockAccount(baseaddr, basename,0);
    sendtx(baseaddr, tgtaddr, amount ,'');
}

function increaseHexByOne(strhex) {
 var x = new BigNumber(hex)
 var sum = x.add(1)
 var result = '0x' + sum.toString(16)
 return result
}

/*
{
	"7a813833": "AUTO_RETIRE()",
	"d4f79bd5": "AUTO_RETIRE_COUNT()",
	"312e014b": "BackupUpToDate(uint256)",
	"f21df012": "DEFLATOR_VALUE()",
	"e3bbb4f1": "MAX_GAS_PRICE()",
	"950f7879": "MONITOR_JOIN_FEE()",
	"f2faa2a6": "MONITOR_MIN_FEE()",
	"dc393c09": "NODE_INIT_PERFORMANCE()",
	"dc82c54f": "VnodeProtocolBaseAddr()",
	"a2f09dfa": "addFund()",
	"6f7e15da": "addSyncNode(address,string)",
	"0ac168a1": "blockReward()",
	"c66da997": "checkProposalStatus(bytes32)",
	"43d726d6": "close()",
	"30e7f8ef": "consensusFlag()",
	"0e14f4c0": "createProposal(uint256,bytes32,bytes32,uint256,uint256,uint256[],uint256[],address[],uint256[])",
	"6b35d367": "currentRefundGas(address)",
	"fcac00bc": "flushInRound()",
	"2da03719": "funcCode()",
	
	"c20b1246": "getEstFlushBlock(uint256)",
	"50859fd9": "getSCSRole(address)",
	"d0fab885": "isMemberValid(address)",
	"e5df8425": "joinCntMax()",
	"d12ff2eb": "joinCntNow()",
	"b8598896": "matchSelTarget(address,uint8,uint8)",
	"03e3c9ac": "maxMember()",
	"2b114a7c": "minMember()",
	"6da49b83": "nodeCount()",
	"208f2a31": "nodeList(uint256)",
	"a9555e6c": "nodePerformance(address)",
	"26009deb": "nodeToReleaseCount()",
	"3b082706": "nodesToDispel(uint256)",
	"a94f7a70": "nodesToJoin(uint256)",
	"cae56d58": "nodesToRelease(uint256)",
	"57365df2": "nodesWatching(address)",
	"83d6f697": "penaltyBond()",
	"eba308f8": "proposalExpiration()",
	"db22ccad": "proposalHashApprovedLast()",
	"ca3b852f": "proposalHashInProgress()",
	"32ed5b12": "proposals(bytes32)",
	"8ce74426": "protocol()",
	"cbe5b2a4": "randIndex(uint256)",
	"be93f1b3": "registerAdd(uint256)",
	"9a911393": "registerAsBackup(address,uint8,bytes32,bytes32)",
	"4e592e2f": "registerAsMonitor(address)",
	"99d53d43": "registerAsSCS(address,uint8,bytes32,bytes32)",
	"69f3576f": "registerClose()",
	"5defc56c": "registerOpen()",
	"110afc0f": "removeSyncNode(uint256)",
	"cc819ad0": "requestProposalAction(uint256,bytes32)",
	"063d36a4": "requestRelease(uint256)",
	"2ad0f79b": "scsBeneficiary(address)",
	"d7c3dc5f": "selTarget()",
	"40caae06": "setOwner()",
	"c063d987": "syncNodes(uint256)",
	"c4474a59": "syncReward()",
	"46d63676": "txReward()",
	"b062a927": "viaReward()",
	"bfac6efa": "voteOnProposal(uint256,bytes32)",
	"f3fef3a3": "withdraw(address,uint256)"
}*/


//部署dapp合约
//deChatDeploy("0x27d1645e50912154f5fbfa5895ecd93f9a5fd1e9", 0);

//创建topic    49aa38ce18bc541366c2ce4188f60f48107b67fcd9b20278cea8660a09020021
//createTopicSol(3, 20000, "are you ok,if you do not ok, i will ask you if you happy, if you not happy, i will ask you hh?"
//		, subchainaddr1, 2)
		
//obj.createTopicSol(1, 30, "what is block?"
//, subchainaddr1, 2)

//创建回答  548d7dd81845a7b2083db02e46799bcf7cd39a5a627e47086891654aa2b2e09d
//creatSubTopic("yes, ima fdfdfok", subchainaddr1, 
//		"0x" + "168fcc9df48d777adf82609fc535265e1d61613da922476e7a3f89214d9ad143", 16)

//点赞回答  
// voteOnTopic: function (vote, pwd, subchainaddr,subHash, nonce)
//voteOnTopic(baseaddr, basename, 
//		subchainaddr1,
//		"548d7dd81845a7b2083db02e46799bcf7cd39a5a627e47086891654aa2b2e09d", 4)
		

